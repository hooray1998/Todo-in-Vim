"=================================================================
"		Vim-plug æ’ä»¶ç®¡ç†       
"=================================================================
set nocompatible              " å»é™¤VIä¸€è‡´æ€§,å¿…é¡»è¦æ·»åŠ 
filetype on
call plug#begin('~/.vim/plugged')
" å¼‚æ­¥æ‰§è¡Œ "
Plug 'skywind3000/asyncrun.vim'
" ç¾åŒ–çŠ¶æ€æ å’Œæ ‡ç­¾é¡µ "
Plug 'vim-airline/vim-airline'
Plug 'vim-airline/vim-airline-themes'
" å¢åŠ ç¼©è¿›æŒ‡ç¤ºçº¿ "
Plug 'Yggdroot/indentLine'
" monokai theme
Plug 'patstockwell/vim-monokai-tasty'
call plug#end()

"==================================================================
" æ˜¾ç¤ºç›¸å…³  
"==================================================================
syntax on
set nu
set shiftwidth=4
set go=             " ä¸è¦å›¾å½¢æŒ‰é’®  
"set guifont=Monaco:h26   " è®¾ç½®å­—ä½“  
autocmd InsertLeave * se nocul  " ç”¨æµ…è‰²é«˜äº®å½“å‰è¡Œ  
autocmd InsertEnter * se cul    " ç”¨æµ…è‰²é«˜äº®å½“å‰è¡Œ  
set showcmd         " è¾“å…¥çš„å‘½ä»¤æ˜¾ç¤ºå‡ºæ¥ï¼Œçœ‹çš„æ¸…æ¥šäº›  
"set novisualbell    " ä¸è¦é—ªçƒ(ä¸æ˜ç™½)  
set laststatus=2    " å¯åŠ¨æ˜¾ç¤ºçŠ¶æ€è¡Œ(1),æ€»æ˜¯æ˜¾ç¤ºçŠ¶æ€è¡Œ(2)  

"ç¼–ç "
set fencs=utf-8,ucs-bom,shift-jis,gb18030,gbk,gb2312,cp936
set termencoding=utf-8
set encoding=utf-8
set fileencodings=ucs-bom,utf-8,cp936
set fileencoding=utf-8

"==================================================================
"	å®ç”¨è®¾ç½®
"==================================================================

" è®¾ç½®å½“æ–‡ä»¶è¢«æ”¹åŠ¨æ—¶è‡ªåŠ¨è½½å…¥
set autoread
"ä»£ç è¡¥å…¨ 
set completeopt=preview,menu 
" è®¾å®šè¡¥å…¨è¡Œä¸º"
set wildmode=full

"å…è®¸æ’ä»¶  
"é€šè¿‡% å®ç°XMLæ ‡ç­¾çš„è·³è½¬"
set nocompatible
filetype plugin on
runtime macros/matchit.vim
"å…±äº«å‰ªè´´æ¿  
set clipboard+=unnamed 
"ä»ä¸å¤‡ä»½  
set nobackup
"è‡ªåŠ¨ä¿å­˜
set autowrite
set autoread
set ruler					" æ˜¾ç¤ºçŠ¶æ€æ æ ‡å°º"
set cursorline              " çªå‡ºæ˜¾ç¤ºå½“å‰è¡Œ
set magic                   " è®¾ç½®é­”æœ¯
set guioptions-=T           " éšè—å·¥å…·æ 
set guioptions-=m           " éšè—èœå•æ 
" è®¾ç½®åœ¨çŠ¶æ€è¡Œæ˜¾ç¤ºçš„ä¿¡æ¯
set foldenable              " å¼€å§‹æŠ˜å 
set foldcolumn=0
set foldmethod=indent 
set foldlevel=3 
set foldlevelstart=99

" å»æ‰è¾“å…¥é”™è¯¯çš„æç¤ºå£°éŸ³
set noeb
" åœ¨å¤„ç†æœªä¿å­˜æˆ–åªè¯»æ–‡ä»¶çš„æ—¶å€™ï¼Œå¼¹å‡ºç¡®è®¤
set confirm
" è‡ªåŠ¨ç¼©è¿›
set autoindent
set cindent
" Tabé”®çš„å®½åº¦
set tabstop=4
" ç»Ÿä¸€ç¼©è¿›ä¸º4
set softtabstop=4
set shiftwidth=4
" ä¸è¦ç”¨ç©ºæ ¼ä»£æ›¿åˆ¶è¡¨ç¬¦
set noexpandtab
" åœ¨è¡Œå’Œæ®µå¼€å§‹å¤„ä½¿ç”¨åˆ¶è¡¨ç¬¦
set smarttab
" å†å²è®°å½•æ•°
set history=1000
"ç¦æ­¢ç”Ÿæˆä¸´æ—¶æ–‡ä»¶
set nobackup
set noswapfile
"æœç´¢å¿½ç•¥å¤§å°å†™
set ignorecase
" å¦‚æœæœ‰ä¸€ä¸ªå¤§å†™å­—æ¯ï¼Œåˆ™åˆ‡æ¢åˆ°å¤§å°å†™æ•æ„ŸæŸ¥æ‰¾
set smartcase
"æœç´¢é€å­—ç¬¦é«˜äº®
set hlsearch
set incsearch
"è¡Œå†…æ›¿æ¢
set gdefault
"è¯­è¨€è®¾ç½®
set langmenu=zh_CN.UTF-8
set helplang=cn
" å‘½ä»¤è¡Œï¼ˆåœ¨çŠ¶æ€è¡Œä¸‹ï¼‰çš„é«˜åº¦ï¼Œé»˜è®¤ä¸º1ï¼Œè¿™é‡Œæ˜¯2
set cmdheight=1
" ä¿å­˜å…¨å±€å˜é‡
set viminfo+=!
" å¸¦æœ‰å¦‚ä¸‹ç¬¦å·çš„å•è¯ä¸è¦è¢«æ¢è¡Œåˆ†å‰²
set iskeyword+=_,$,@,%,#,-
" å­—ç¬¦é—´æ’å…¥çš„åƒç´ è¡Œæ•°ç›®
set linespace=0
" å¢å¼ºæ¨¡å¼ä¸­çš„å‘½ä»¤è¡Œè‡ªåŠ¨å®Œæˆæ“ä½œ
set wildmenu
" ä½¿å›æ ¼é”®ï¼ˆbackspaceï¼‰æ­£å¸¸å¤„ç†indent, eol, startç­‰
set backspace=2
" å…è®¸backspaceå’Œå…‰æ ‡é”®è·¨è¶Šè¡Œè¾¹ç•Œ
set whichwrap+=<,>,h,l
" å¯ä»¥åœ¨bufferçš„ä»»ä½•åœ°æ–¹ä½¿ç”¨é¼ æ ‡ï¼ˆç±»ä¼¼officeä¸­åœ¨å·¥ä½œåŒºåŒå‡»é¼ æ ‡å®šä½ï¼‰
set mouse=a
set selection=exclusive
set selectmode=mouse,key
" é€šè¿‡ä½¿ç”¨: commandså‘½ä»¤ï¼Œå‘Šè¯‰æˆ‘ä»¬æ–‡ä»¶çš„å“ªä¸€è¡Œè¢«æ”¹å˜è¿‡
set report=0
" åœ¨è¢«åˆ†å‰²çš„çª—å£é—´æ˜¾ç¤ºç©ºç™½ï¼Œä¾¿äºé˜…è¯»
set fillchars=vert:\ ,stl:\ ,stlnc:\
" é«˜äº®æ˜¾ç¤ºåŒ¹é…çš„æ‹¬å·
set showmatch
" åŒ¹é…æ‹¬å·é«˜äº®çš„æ—¶é—´ï¼ˆå•ä½æ˜¯ååˆ†ä¹‹ä¸€ç§’ï¼‰
set matchtime=1
" å…‰æ ‡ç§»åŠ¨åˆ°bufferçš„é¡¶éƒ¨å’Œåº•éƒ¨æ—¶ä¿æŒ3è¡Œè·ç¦»
set scrolloff=3
" ä¸ºCç¨‹åºæä¾›è‡ªåŠ¨ç¼©è¿›
set smartindent
" é«˜äº®æ˜¾ç¤ºæ™®é€štxtæ–‡ä»¶ï¼ˆéœ€è¦txt.vimè„šæœ¬ï¼‰
au BufRead,BufNewFile *  setfiletype txt
filetype plugin indent on 
"æ‰“å¼€æ–‡ä»¶ç±»å‹æ£€æµ‹, åŠ äº†è¿™å¥æ‰å¯ä»¥ç”¨æ™ºèƒ½è¡¥å…¨
set completeopt=longest,menu

"airline options
if !exists('g:airline_symbols')
let g:airline_symbols = {}
endif

" powerline symbols
let g:airline_left_sep = 'î‚°'
let g:airline_left_alt_sep = 'î‚±'
let g:airline_right_sep = ''   "'î‚²'
let g:airline_right_alt_sep = 'î‚³'
let g:airline_symbols.branch = 'î‚ '
let g:airline_symbols.readonly = 'î‚¢'
let g:airline_symbols.linenr = 'â˜°'
let g:airline_symbols.maxlinenr = 'î‚¡'

let g:airline_powerline_fonts=1
set laststatus=2 "1ä¸ºå…³é—­åº•éƒ¨çŠ¶æ€æ  2ä¸ºå¼€å¯"
set t_Co=256     "ç»ˆç«¯å¼€å¯256è‰²æ”¯æŒ"
set ambiwidth=double "é˜²æ­¢ç‰¹æ®Šç¬¦å·æ— æ³•æ­£å¸¸æ˜¾ç¤º
let g:airline#extensions#tabline#enabled=1 "é¡¶éƒ¨tabæ˜¾ç¤º
"let g:airline_theme='bubblegum'  "murmuré…è‰²ä¹Ÿä¸é”™
"C-l æ¸…é™¤é«˜äº®
nnoremap <silent> <C-l> :<C-u>nohlsearch<CR><C-l>


" é‡å®šä¹‰*, ä½¿å…¶é‚£èƒ½å¤Ÿæœç´¢é€‰ä¸­æ–‡æœ¬
xnoremap * : <C-u> call <SID>VSetSearch()<CR>/<C-R>=@/<CR><CR>
xnoremap # : <C-u> call <SID>VSetSearch()<CR>?<C-R>=@/<CR><CR>

function! s:VSetSearch()
let temp = @s
norm! gv"sy
let @/ = '\V' . substitute(escape(@s, '/\'), '\n', '\\n', 'g')
let @s = temp
endfunction



" è®¾ç½®é…è‰²æ–¹æ¡ˆ
set background=dark
"let g:vim_monokai_tasty_italic = 1 "åŠ ä¸Šè¿™å¥å æ³¨é‡Šä¼šæœ‰åº•è‰²ï¼Œå¾ˆä¸‘"
colorscheme vim-monokai-tasty
let g:lightline = { 'colorscheme': 'monokai_tasty', }
let g:airline_theme='monokai_tasty'

"=================================================================
"é”®ç›˜å‘½ä»¤
"=================================================================

"è®¾ç½®<leader>ä¸ºç©ºæ ¼é”®
let mapleader="\<Space>"

nnoremap <Tab> :bn<CR>
nnoremap <S-Tab> :bp<CR>
nnoremap <leader>i :bd %<CR><CR>
"é‡æ˜ å°„"
cnoremap <C-p> <Up>
cnoremap <C-n> <Down>

"H,Lç§»åŠ¨åˆ°è¡Œé¦–è¡Œå°¾
map H ^
map L $
"å¯è§†æ¨¡å¼ä¸‹ç§»åŠ¨åˆ°è¡Œå°¾
vnoremap L $h

"ä¿å­˜æ–‡ä»¶
nnoremap <leader>w :w<CR>
nnoremap <leader>e :wqall<CR>
"nnoremap <leader>e :call PushAndExit()<CR>
"å¿«æ·å¤åˆ¶ç²˜è´´è‡³ç³»ç»Ÿ
nnoremap <C-A> ggVG"+y<CR>


"=================================================================
"	for TODO
"=================================================================

"è¿½åŠ è¯¥è¡Œåˆ°æ–‡ä»¶study

nnoremap <C-N> A â˜…0w
nnoremap <C-J> :.s/â˜/âœ”/g<CR>j<C-L>
nnoremap <Enter> :.s/â˜/âœ”/g<CR>j<C-L>
nnoremap <C-K> :.s/âœ”/â˜/g<CR>j:nohlsearch<CR>
nnoremap <C-H> A<C-H><C-H>
nnoremap <Backspace> :.s/ â˜…//g<CR>:nohlsearch<CR>
nnoremap o oâ˜ 
inoremap <Enter> <Enter>â˜ 
nnoremap u u:nohlsearch<CR>
inoremap <Tab> ma>>`ala
inoremap <S-Tab> ma<<`aa
nnoremap ]] /@<CR>:nohlsearch<CR>
nnoremap [[ ?@<CR>:nohlsearch<CR>

au BufRead,BufNewFile *.todo,*.Todo set filetype=todo

augroup vimrc
	autocmd User AsyncRunStart call asyncrun#quickfix_toggle(8, 1)
augroup END

"=================================================================
" Todoå¼‚æ­¥æ›´æ–°
"=================================================================
autocmd bufwritepost *.todo,*.Todo call Push()
func Push() 
	call system("git add --all")
	call system("git commit -m \"`whoami` @  `hostname` in `date +%y-%m-%d=%H:%M:%S`\"")
	exec ":AsyncRun git push origin master"
endfunc 
"func PushAndExit() 
	"call system("git add --all")
	"call system("git commit -m \"`whoami` @  `hostname` in `date +%y-%m-%d=%H:%M:%S`\"")
	"call system("git push origin master")
	"exec ":wqall"
"endfunc 

"æ¯æ¬¡å¯åŠ¨Todoæ—¶éƒ½å…ˆæœ€æ–°ç‰ˆ"
au VimEnter *.todo,*.Todo call Pull()
func Pull() 
	exec ":cd %:h"
	exec ":AsyncRun git pull origin master"
	autocmd User AsyncRunStop exec ":ccl"
	autocmd User AsyncRunStop exec ":e %"
endfunc 

